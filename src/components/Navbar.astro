---
import type { NavItem } from '@data/types';
import navigation from '@data/navigation.yml';

const { pathname } = Astro.url;
const navItems: NavItem[] = navigation.filter((item: NavItem) => item.showInMainNav);

const isExternal = (href: string) => href.startsWith('http') || href.startsWith('//');

const isActive = (href: string) => {
  if (href === '/') return pathname === href;
  return pathname.startsWith(href);
};
---

<header>
  <p><a href="/">Clouder</a></p>
  <nav>
    {
      navItems.map(({ title, href }) => (
        <a
          href={href}
          aria-current={isActive(href) ? 'page' : undefined}
          class="nav-link"
          {...(isExternal(href) && {
            target: '_blank',
            rel: 'noopener noreferrer'
          })}
        >
          {title}
        </a>
      ))
    }
  </nav>
</header>

<style>
  header {
    display: flex;
    align-items: center;
    padding: 1rem;
  }

  p {
    margin-right: auto;
  }

  nav {
    display: flex;
    gap: 1rem;
  }

  a {
    color: currentColor;
    text-decoration: none;

    &[aria-current='page'] {
      text-decoration: underline;
    }
  }
</style>
